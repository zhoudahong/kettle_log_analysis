<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>1财务核对_mysql</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/11/13 12:07:13.868</created_date>
    <modified_user>-</modified_user>
    <modified_date>2018/11/13 12:07:13.868</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>172.16.2.229_mysql</name>
    <server>172.16.2.229</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>xxf_cw</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.characterEncoding </code>
        <attribute>gbk</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.characterSetResults</code>
        <attribute>gbk</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.defaultFetchSize</code>
        <attribute>500</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCursorFetch</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useUnicode</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.0.2_xxfbooks</name>
    <server>192.168.0.2</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>xxfbooks</database>
    <port>1433</port>
    <username>tlx</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ff228dc6fa8c</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.21.2_cqbooks2</name>
    <server>192.168.21.2</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>cqbooks2</database>
    <port>1433</port>
    <username>tlx</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ff228dc6fa8c</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.21.44_mysql</name>
    <server>192.168.21.44</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>xxf_cw</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.21.44_sisyphe_edw</name>
    <server>192.168.21.44</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>sisyphe_edw</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Linux192.168.21.47_coffee_activity</name>
    <server>192.168.21.83</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>coffee_activity</database>
    <port>3306</port>
    <username>e_tlx</username>
    <password>Encrypted 67515074daade2ac13e5a3a68003fa5df1a5fbee</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Linux192.168.21.47_coffee_baseinfo_v2</name>
    <server>192.168.21.83</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>coffee_baseinfo_v2</database>
    <port>3306</port>
    <username>e_tlx</username>
    <password>Encrypted 67515074daade2ac13e5a3a68003fa5df1a5fbee</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Linux192.168.21.47_member_database</name>
    <server>192.168.21.83</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>member_database</database>
    <port>3306</port>
    <username>e_tlx</username>
    <password>Encrypted 67515074daade2ac13e5a3a68003fa5df1a5fbee</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>mysql数据源</from>
      <to>mysql目的端</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>sqlserver数据源</from>
      <to>mysql目的端 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>sqlserver数据源 2</from>
      <to>mysql目的端 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>mysql数据源 2</from>
      <to>mysql目的端 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>mysql_储值卡扣款金额</from>
      <to>mysql目的端 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>coupon</from>
      <to>mysql目的端 4 2</to>
      <enabled>N</enabled>
    </hop>
  </order>
  <step>
    <name>coupon</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Linux192.168.21.47_coffee_activity</connection>
    <sql>select * from `coffee_activity`.`coupon`
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql_储值卡扣款金额</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Linux192.168.21.47_coffee_baseinfo_v2</connection>
    <sql>select 操作时间,操作站点,业务类型,支付方式,所属类别,sum(支付金额) as 支付金额 from (
select str_to_date(`t`.`create_time`, '%Y-%m-%d')  AS `操作时间`,
                                         `d`.`station_name`                          AS `操作站点`,
                                         '书店'                                        AS `业务类型`,
                                         '储值卡'                                       AS `支付方式`,
                                         '扣款金额'                                   AS `所属类别`,
                                         (sum((case
                                                 when (`t`.`in_out_flag` = -(1))
                                                         then (case when isnull(`t`.`trade_amount`) then 0 else `t`.`trade_amount` end)
                                                 else 0 end)) - sum((case
                                                                       when (`t`.`in_out_flag` = 1)
                                                                               then (case when isnull(`t`.`trade_amount`) then 0 else `t`.`trade_amount` end)
                                                                       else 0 end))) AS `支付金额`
                                  from (((`askcard_db`.`trade_record` `t` left join `askcard_db`.`card_info` `c` on ((
                                    `t`.`card_id` = `c`.`card_id`))) left join `coffee_baseinfo_v2`.`station` `d` on ((
                                    `d`.`station_code` =
                                    `t`.`station_code`))) left join `oauth_database`.`user` `e` on ((`t`.`operator_code`
                                                                                                     =
                                                                                                     `e`.`user_code`)))
                                  where ((`t`.`status` = 'Succeed') and (`d`.`station_name` like '%书店%') and
                                         (`t`.`trade_type` in ('Consume','CardConsume', 'CardConsumeRefund','ConsumeAdjustAdd', 'ConsumeRefund','ConsumeAdjustReduce')))
                                  group by str_to_date(`t`.`create_time`, '%Y-%m-%d'), `d`.`station_name`

union all
select str_to_date(`t`.`create_time`, '%Y-%m-%d')  AS `操作时间`,
                                                   `d`.`station_name`                          AS `操作站点`,
                                                   '咖啡'                                        AS `业务类型`,
                                                   '储值卡'                                       AS `支付方式`,
                                                   '扣款金额'                                   AS `所属类别`,
                                                   (sum((case
                                                           when (`t`.`in_out_flag` = -(1))
                                                                   then (case when isnull(`t`.`trade_amount`) then 0 else `t`.`trade_amount` end)
                                                           else 0 end)) - sum((case
                                                                                 when (`t`.`in_out_flag` = 1)
                                                                                         then (case when isnull(`t`.`trade_amount`) then 0 else `t`.`trade_amount` end)
                                                                                 else 0 end))) AS `支付金额`
                                            from (((`askcard_db`.`trade_record` `t` left join `askcard_db`.`card_info` `c` on ((
                                              `t`.`card_id` =
                                              `c`.`card_id`))) left join `coffee_baseinfo_v2`.`station` `d` on ((
                                              `d`.`station_code` =
                                              `t`.`station_code`))) left join `oauth_database`.`user` `e` on ((
                                              `t`.`operator_code` = `e`.`user_code`)))
                                            where ((`t`.`status` = 'Succeed') and (`d`.`station_name` like '%咖啡%') and
                                                   (`t`.`trade_type` in ('Consume','CardConsume', 'CardConsumeRefund','ConsumeAdjustAdd','ConsumeRefund','ConsumeAdjustReduce')))
                                            group by str_to_date(`t`.`create_time`, '%Y-%m-%d'), `d`.`station_name`


)a where 操作时间>DATE_SUB(curdate(),INTERVAL +9 DAY)
group by 操作时间,操作站点,业务类型,支付方式,所属类别

/*
select
  操作时间,
  操作站点,
  业务类型,
  支付方式,
  所属类别,
  sum(支付金额) as 支付金额
from (
       select
         str_to_date(`t`.`create_time`, '%Y-%m-%d') AS `操作时间`,
         `d`.`station_name`                         AS `操作站点`,
         '书店'                                       AS `业务类型`,
         '储值卡'                                      AS `支付方式`,
         '扣款金额'                                     AS `所属类别`,
         (sum((case
               when (`t`.`in_out_flag` = -(1))
                 then (case when isnull(`t`.`trade_amount`)
                   then 0
                       else `t`.`trade_amount` end)
               else 0 end)) - sum((case
                                   when (`t`.`in_out_flag` = 1)
                                     then (case when isnull(`t`.`trade_amount`)
                                       then 0
                                           else `t`.`trade_amount` end)
                                   else 0 end)))    AS `支付金额`
       from (((sisyphe_ods.`askcard_db_trade_record` `t` left join sisyphe_ods.`askcard_db_card_info` `c` on ((
         `t`.`card_id` = `c`.`card_id`))) left join sisyphe_ods.`coffee_baseinfo_v2_station` `d` on ((
         `d`.`station_code` =
         `t`.`station_code`))) left join sisyphe_ods.`oauth_database_user` `e` on ((`t`.`operator_code`
                                                                          =
                                                                          `e`.`user_code`)))
       where ((`t`.`status` = 'Succeed') and (`d`.`station_name` like '%书店%') and
              (`t`.`trade_type` in
               ('Consume', 'CardConsume', 'CardConsumeRefund', 'ConsumeAdjustAdd', 'ConsumeRefund', 'ConsumeAdjustReduce')))
       group by str_to_date(`t`.`create_time`, '%Y-%m-%d'), `d`.`station_name`

       union all
       select
         str_to_date(`t`.`create_time`, '%Y-%m-%d') AS `操作时间`,
         `d`.`station_name`                         AS `操作站点`,
         '咖啡'                                       AS `业务类型`,
         '储值卡'                                      AS `支付方式`,
         '扣款金额'                                     AS `所属类别`,
         (sum((case
               when (`t`.`in_out_flag` = -(1))
                 then (case when isnull(`t`.`trade_amount`)
                   then 0
                       else `t`.`trade_amount` end)
               else 0 end)) - sum((case
                                   when (`t`.`in_out_flag` = 1)
                                     then (case when isnull(`t`.`trade_amount`)
                                       then 0
                                           else `t`.`trade_amount` end)
                                   else 0 end)))    AS `支付金额`
       from (((sisyphe_ods.`askcard_db_trade_record` `t` left join sisyphe_ods.`askcard_db_card_info` `c` on ((
         `t`.`card_id` =
         `c`.`card_id`))) left join sisyphe_ods.`coffee_baseinfo_v2_station` `d` on ((
         `d`.`station_code` =
         `t`.`station_code`))) left join sisyphe_ods.`oauth_database_user` `e` on ((
         `t`.`operator_code` = `e`.`user_code`)))
       where ((`t`.`status` = 'Succeed') and (`d`.`station_name` like '%咖啡%') and
              (`t`.`trade_type` in
               ('Consume', 'CardConsume', 'CardConsumeRefund', 'ConsumeAdjustAdd', 'ConsumeRefund', 'ConsumeAdjustReduce')))
       group by str_to_date(`t`.`create_time`, '%Y-%m-%d'), `d`.`station_name`


     ) a
where 操作时间 > DATE_SUB(curdate(), INTERVAL +9 DAY)
group by 操作时间, 操作站点, 业务类型, 支付方式, 所属类别
*/
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql数据源</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Linux192.168.21.47_member_database</connection>
    <sql>
select str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
                                               `b`.`station_name`                         AS `站点`,
                                               `c`.`pay_method_name`                      AS `支付方式`,
                                               sum(a.in_out_flag*`c`.`pay_amount`) AS `支付金额`,
                                               '售卡充值'                                     AS `所属类别`,
                                               '咖啡'                                       AS `业务类型`,
                                               `b`.`station_code`                         AS `站点ID`
                                        from (((`askcard_db`.`trade_record` `a` join `coffee_baseinfo_v2`.`station` `b` on ((
                                          `a`.`station_code` =
                                          `b`.`station_code`))) join `askcard_db`.`pay_detail` `c` on ((`a`.`trade_id` =
                                                                                                        `c`.`trade_id`))))
                                        where ((`a`.`trade_type` in ('Recharge','RechargeAdjustAdd','RechargeAdjustReduce','RechargeRefund','RechargeRollback')) and
                                               (`b`.`site_type` = 'CAFE')
                                                  and   `a`.`create_time`>DATE_SUB(curdate(),INTERVAL +9 DAY)
                                                  ) and a.status='Succeed'
                                        group by `支付日期`, `站点`, `支付方式`, `站点ID`
                              union all select str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
                                               `b`.`station_name`                         AS `站点`,
                                               `d`.`pay_method_name`                      AS `支付方式`,
                                               sum(`a`.`pay_amount`)                      AS `支付金额`,
                                               '售卡充值退款'                                   AS `所属类别`,
                                               '咖啡'                                       AS `业务类型`,
                                               `b`.`station_code`                         AS `站点ID`
                                        from (((`askcard_db`.`trade_record` `a` join `coffee_baseinfo_v2`.`station` `b` on ((
                                          `a`.`station_code` =
                                          `b`.`station_code`))) join `askcard_db`.`pay_detail` `c` on ((`a`.`trade_id` =
                                                                                                        `c`.`trade_id`))) join `coffee_sale`.`pay_method` `d` on ((
                                          `c`.`pay_method_id` = `d`.`pay_method_code`)))
                                        where ((`a`.`trade_type` in
                                                ('RechargeRefund', 'RechargeAdjustReduce', 'RechargeRollback')) and
                                               (`b`.`site_type` = 'CAFE'))and `a`.`create_time`>DATE_SUB(curdate(),INTERVAL +9 DAY) and a.status='Succeed'
                                        group by `支付日期`, `站点`, `支付方式`, `站点ID`
                              union all select str_to_date(`b`.`create_time`, '%Y-%m-%d') AS `str_to_date(b.create_time,'%Y-%m-%d')`,
                                               `c`.`station_name`                         AS `station_name`,
                                               `d`.`pay_method_name`                      AS `pay_method_name`,
                                               sum(`a`.`pay_money`)                       AS `金额`,
                                               '零售'                                       AS `支付类型`,
                                               '咖啡'                                       AS `店铺类型`,
                                               `c`.`station_code`                         AS `站点ID`
                                        from ((`coffee_sale`.`sale_pay_detail` `a` join `coffee_sale`.`sale_order` `b` on ((
                                          `a`.`sale_order_sale_order_code` =
                                          `b`.`sale_order_code`))) join `coffee_baseinfo_v2`.`station` `c` on ((
                                          `b`.`station_code` = `c`.`station_code`)) join coffee_sale.pay_method d on a.pay_method_code=d.pay_method_code)
                                        where ((`b`.`sale_order_type` = 'Order') and (`c`.`site_type` = 'CAFE')
                                         and `b`.`create_time`>DATE_SUB(curdate(),INTERVAL +9 DAY))
                                        group by str_to_date(`b`.`create_time`, '%Y-%m-%d'), `c`.`station_name`,
                                                 `d`.`pay_method_name`, `a`.`pay_money`, `c`.`station_code`
                              union all select str_to_date(`b`.`create_time`, '%Y-%m-%d') AS `str_to_date(b.create_time,'%Y-%m-%d')`,
                                               `c`.`station_name`                         AS `station_name`,
                                               `d`.`pay_method_name`                      AS `pay_method_name`,
                                               sum(`a`.`pay_money`)                       AS `金额`,
                                               '零售退款金额'                                   AS `支付类型`,
                                               '咖啡'                                       AS `店铺类型`,
                                               `c`.`station_code`                         AS `站点ID`
                                        from ((`coffee_sale`.`sale_pay_detail` `a` join `coffee_sale`.`sale_order` `b` on ((
                                          `a`.`sale_order_sale_order_code` =
                                          `b`.`sale_order_code`))) join `coffee_baseinfo_v2`.`station` `c` on ((
                                          `b`.`station_code` = `c`.`station_code`))
                                            inner join coffee_sale.pay_method d on a.pay_method_code=d.pay_method_code
                                            )
                                        where ((`c`.`site_type` = 'CAFE') and (`b`.`sale_order_type` = 'BackOrder')
                                                  and `b`.`create_time`>DATE_SUB(curdate(),INTERVAL +9 DAY))
                                        group by str_to_date(`b`.`create_time`, '%Y-%m-%d'), `c`.`station_name`,
                                                 `a`.`pay_method_name`, `a`.`pay_money`, `c`.`station_code`
                              union all select str_to_date(`a`.`update_time`, '%Y-%m-%d') AS `时间`,
                                               `c`.`station_name`                         AS `station_name`,
                                               `b`.`pay_method_name`                      AS `支付方式`,
                                               sum(`b`.`pay_amount`)                      AS `金额`,
                                               '会员卡'                                      AS `支付类型`,
                                               '咖啡'                                       AS `店铺类型`,
                                               `c`.`station_code`                         AS `station_code`
                                        from ((`member_database`.`trade_record` `a` left join `member_database`.`pay_detail` `b` on ((
                                          `a`.`trade_id` =
                                          `b`.`trade_id`))) join `coffee_baseinfo_v2`.`station` `c` on ((
                                          `a`.`station_code` = `c`.`station_code`)))
                                        where ((`a`.`trade_type` in ('UpdateCard', 'NewRegister', 'Replacement')) and a.status='Succeed' and
                                               (`c`.`site_type` = 'CAFE') and `a`.`create_time`>DATE_SUB(curdate(),INTERVAL +9 DAY)) -- and a.status='Succeed'
                                        group by str_to_date(`a`.`create_time`, '%Y-%m-%d'), `c`.`station_name`,
                                                 `b`.`pay_method_name`, `c`.`station_code`
                              union all select str_to_date(`a`.`update_time`, '%Y-%m-%d')                        AS `支付时间`,
                                               `b`.`station_name`                                                AS `站点`,
                                               (case
                                                  when (`a`.`alipay` >= 10) then '支付宝'
                                                  when (`a`.`bank` >= 10) then '银行卡'
                                                  when (`a`.`cash` >= 10) then '现金'
                                                  when (`a`.`we_chat` >= 10) then '微信支付'
                                                  else '其它' end)                                                 AS `支付方式`,
                                               sum((((`a`.`alipay` + `a`.`bank`) + `a`.`cash`) + `a`.`we_chat`)) AS `金额`,
                                               '会员卡'                                                             AS `业务类型`,
                                               '书店'                                                              AS `店铺类型`,
                                               `b`.`station_code`                                                AS `站点ID`
                                        from (`member_database`.`member_statistics` `a` join `coffee_baseinfo_v2`.`station` `b` on ((
                                          (`a`.`register_station` = `b`.`station_code`) and
                                          (`b`.`site_type` = 'BOOKSTORE'))))where  `a`.`update_time`>DATE_SUB(curdate(),INTERVAL +9 DAY)
                                        group by str_to_date(`a`.`update_time`, '%Y-%m-%d'), (case
                                                                                                when (`a`.`alipay` >= 10)
                                                                                                        then '支付宝'
                                                                                                when (`a`.`bank` >= 10)
                                                                                                        then '银行卡'
                                                                                                when (`a`.`cash` >= 10)
                                                                                                        then '现金'
                                                                                                when (`a`.`we_chat` >= 10)
                                                                                                        then '微信支付'
                                                                                                else '其它' end),
                                                 `b`.`station_name`, `b`.`station_code`
                              union all  select str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
                                               `b`.`station_name`                         AS `站点`,
                                               `c`.`pay_method_name`                      AS `支付方式`,
                                               sum(a.in_out_flag*`c`.`pay_amount`) AS `支付金额`,
                                               '售卡充值'                                     AS `所属类别`,
                                               '书店'                                       AS `业务类型`,
                                               `b`.`station_code`                         AS `站点ID`
                                        from (((`askcard_db`.`trade_record` `a` join `coffee_baseinfo_v2`.`station` `b` on ((
                                          `a`.`station_code` =
                                          `b`.`station_code`))) join `askcard_db`.`pay_detail` `c` on ((`a`.`trade_id` =
                                                                                                        `c`.`trade_id`))))
                                        where ((`a`.`trade_type` in ('Recharge','RechargeAdjustAdd','RechargeAdjustReduce','RechargeRefund','RechargeRollback')) and
                                               (`b`.`site_type` = 'BOOKSTORE')
                                                  and   `a`.`create_time`>DATE_SUB(curdate(),INTERVAL +9 DAY)
                                                  ) and a.status='Succeed'
                                        group by `支付日期`, `站点`, `支付方式`, `站点ID`
                              union all select str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
                                               `b`.`station_name`                         AS `站点`,
                                               `d`.`pay_method_name`                      AS `支付方式`,
                                               sum(`a`.`pay_amount`)                      AS `支付金额`,
                                               '售卡充值退款'                                   AS `所属类别`,
                                               '书店'                                       AS `业务类型`,
                                               `b`.`station_code`                         AS `站点ID`
                                        from (((`askcard_db`.`trade_record` `a` join `coffee_baseinfo_v2`.`station` `b` on ((
                                          `a`.`station_code` =
                                          `b`.`station_code`))) join `askcard_db`.`pay_detail` `c` on ((`a`.`trade_id` =
                                                                                                        `c`.`trade_id`))) join `coffee_sale`.`pay_method` `d` on ((
                                          `c`.`pay_method_id` = `d`.`pay_method_code`)))
                                        where ((`a`.`trade_type` in
                                                ('RechargeRefund', 'RechargeAdjustReduce', 'RechargeRollback')) and
                                               (`b`.`site_type` = 'BOOKSTORE') and   `a`.`create_time`>DATE_SUB(curdate(),INTERVAL +9 DAY)) and a.status='Succeed'
                                        group by `支付日期`, `站点`, `支付方式`, `站点ID`;



/*
select
  str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
  `b`.`station_name`                         AS `站点`,
  `c`.`pay_method_name`                      AS `支付方式`,
  sum(a.in_out_flag * `c`.`pay_amount`)      AS `支付金额`,
  '售卡充值'                                     AS `所属类别`,
  '咖啡'                                       AS `业务类型`,
  `b`.`station_code`                         AS `站点ID`
from (((sisyphe_ods.`askcard_db_trade_record` `a`
  join sisyphe_ods.coffee_baseinfo_v2_station `b` on ((
    `a`.`station_code` =
    `b`.`station_code`))) join sisyphe_ods.`askcard_db_pay_detail` `c` on ((`a`.`trade_id` =
                                                                  `c`.`trade_id`))))
where ((`a`.`trade_type` in
        ('Recharge', 'RechargeAdjustAdd', 'RechargeAdjustReduce', 'RechargeRefund', 'RechargeRollback')) and
       (`b`.`site_type` = 'CAFE')
       and `a`.`create_time` > DATE_SUB(curdate(), INTERVAL +9 DAY)
      ) and a.status = 'Succeed'
group by `支付日期`, `站点`, `支付方式`, `站点ID`
union all select
            str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
            `b`.`station_name`                         AS `站点`,
            `d`.`pay_method_name`                      AS `支付方式`,
            sum(`a`.`pay_amount`)                      AS `支付金额`,
            '售卡充值退款'                                   AS `所属类别`,
            '咖啡'                                       AS `业务类型`,
            `b`.`station_code`                         AS `站点ID`
          from (((sisyphe_ods.`askcard_db_trade_record` `a`
            join sisyphe_ods.`coffee_baseinfo_v2_station` `b` on ((
              `a`.`station_code` =
              `b`.`station_code`))) join sisyphe_ods.`askcard_db_pay_detail` `c` on ((`a`.`trade_id` =
                                                                            `c`.`trade_id`))) join
            sisyphe_ods.`coffee_sale_pay_method` `d` on ((
              `c`.`pay_method_id` = `d`.`pay_method_code`)))
          where ((`a`.`trade_type` in
                  ('RechargeRefund', 'RechargeAdjustReduce', 'RechargeRollback')) and
                 (`b`.`site_type` = 'CAFE')) and `a`.`create_time` > DATE_SUB(curdate(), INTERVAL +9 DAY) and
                a.status = 'Succeed'
          group by `支付日期`, `站点`, `支付方式`, `站点ID`
union all select
            str_to_date(`b`.`create_time`, '%Y-%m-%d') AS `str_to_date(b.create_time,'%Y-%m-%d')`,
            `c`.`station_name`                         AS `station_name`,
            `d`.`pay_method_name`                      AS `pay_method_name`,
            sum(`a`.`pay_money`)                       AS `金额`,
            '零售'                                       AS `支付类型`,
            '咖啡'                                       AS `店铺类型`,
            `c`.`station_code`                         AS `站点ID`
          from ((sisyphe_ods.coffee_sale_sale_pay_detail `a`
            join sisyphe_ods.`coffee_sale_sale_order` `b` on ((
              `a`.`sale_order_sale_order_code` =
              `b`.`sale_order_code`))) join sisyphe_ods.`coffee_baseinfo_v2_station` `c` on ((
            `b`.`station_code` = `c`.`station_code`))
            join sisyphe_ods.coffee_sale_pay_method d on a.pay_method_code = d.pay_method_code)
          where ((`b`.`sale_order_type` = 'Order') and (`c`.`site_type` = 'CAFE')
                 and `b`.`create_time` > DATE_SUB(curdate(), INTERVAL +9 DAY))
          group by str_to_date(`b`.`create_time`, '%Y-%m-%d'), `c`.`station_name`,
            `d`.`pay_method_name`, `a`.`pay_money`, `c`.`station_code`
union all select
            str_to_date(`b`.`create_time`, '%Y-%m-%d') AS `str_to_date(b.create_time,'%Y-%m-%d')`,
            `c`.`station_name`                         AS `station_name`,
            `d`.`pay_method_name`                      AS `pay_method_name`,
            sum(`a`.`pay_money`)                       AS `金额`,
            '零售退款金额'                                   AS `支付类型`,
            '咖啡'                                       AS `店铺类型`,
            `c`.`station_code`                         AS `站点ID`
          from ((sisyphe_ods.`coffee_sale_sale_pay_detail` `a`
            join sisyphe_ods.`coffee_sale_sale_order` `b` on ((
              `a`.`sale_order_sale_order_code` =
              `b`.`sale_order_code`))) join sisyphe_ods.`coffee_baseinfo_v2_station` `c` on ((
            `b`.`station_code` = `c`.`station_code`))
            inner join sisyphe_ods.coffee_sale_pay_method d on a.pay_method_code = d.pay_method_code
          )
          where ((`c`.`site_type` = 'CAFE') and (`b`.`sale_order_type` = 'BackOrder')
                 and `b`.`create_time` > DATE_SUB(curdate(), INTERVAL +9 DAY))
          group by str_to_date(`b`.`create_time`, '%Y-%m-%d'), `c`.`station_name`,
            `a`.`pay_method_name`, `a`.`pay_money`, `c`.`station_code`
union all select
            str_to_date(`a`.`update_time`, '%Y-%m-%d') AS `时间`,
            `c`.`station_name`                         AS `station_name`,
            `b`.`pay_method_name`                      AS `支付方式`,
            sum(`b`.`pay_amount`)                      AS `金额`,
            '会员卡'                                      AS `支付类型`,
            '咖啡'                                       AS `店铺类型`,
            `c`.`station_code`                         AS `station_code`
          from ((sisyphe_ods.`member_database_trade_record` `a` left join sisyphe_ods.`member_database_pay_detail` `b` on ((
            `a`.`trade_id` =
            `b`.`trade_id`))) join sisyphe_ods.`coffee_baseinfo_v2_station` `c` on ((
            `a`.`station_code` = `c`.`station_code`)))
          where ((`a`.`trade_type` in ('UpdateCard', 'NewRegister', 'Replacement')) and a.status = 'Succeed' and
                 (`c`.`site_type` = 'CAFE') and
                 `a`.`create_time` > DATE_SUB(curdate(), INTERVAL +9 DAY)) -- and a.status='Succeed'
          group by str_to_date(`a`.`create_time`, '%Y-%m-%d'), `c`.`station_name`,
            `b`.`pay_method_name`, `c`.`station_code`
union all select
            str_to_date(`a`.`update_time`, '%Y-%m-%d')                        AS `支付时间`,
            `b`.`station_name`                                                AS `站点`,
            (case
             when (`a`.`alipay` >= 10)
               then '支付宝'
             when (`a`.`bank` >= 10)
               then '银行卡'
             when (`a`.`cash` >= 10)
               then '现金'
             when (`a`.`we_chat` >= 10)
               then '微信支付'
             else '其它' end)                                                   AS `支付方式`,
            sum((((`a`.`alipay` + `a`.`bank`) + `a`.`cash`) + `a`.`we_chat`)) AS `金额`,
            '会员卡'                                                             AS `业务类型`,
            '书店'                                                              AS `店铺类型`,
            `b`.`station_code`                                                AS `站点ID`
          from (sisyphe_ods.`member_database_member_statistics` `a`
            join sisyphe_ods.`coffee_baseinfo_v2_station` `b` on ((
              (`a`.`register_station` = `b`.`station_code`) and
              (`b`.`site_type` = 'BOOKSTORE'))))
          where `a`.`update_time` > DATE_SUB(curdate(), INTERVAL +9 DAY)
          group by str_to_date(`a`.`update_time`, '%Y-%m-%d'), (case
                                                                when (`a`.`alipay` >= 10)
                                                                  then '支付宝'
                                                                when (`a`.`bank` >= 10)
                                                                  then '银行卡'
                                                                when (`a`.`cash` >= 10)
                                                                  then '现金'
                                                                when (`a`.`we_chat` >= 10)
                                                                  then '微信支付'
                                                                else '其它' end),
            `b`.`station_name`, `b`.`station_code`
union all select
            str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
            `b`.`station_name`                         AS `站点`,
            `c`.`pay_method_name`                      AS `支付方式`,
            sum(a.in_out_flag * `c`.`pay_amount`)      AS `支付金额`,
            '售卡充值'                                     AS `所属类别`,
            '书店'                                       AS `业务类型`,
            `b`.`station_code`                         AS `站点ID`
          from (((sisyphe_ods.`askcard_db_trade_record` `a`
            join sisyphe_ods.`coffee_baseinfo_v2_station` `b` on ((
              `a`.`station_code` =
              `b`.`station_code`))) join sisyphe_ods.`askcard_db_pay_detail` `c` on ((`a`.`trade_id` =
                                                                            `c`.`trade_id`))))
          where ((`a`.`trade_type` in
                  ('Recharge', 'RechargeAdjustAdd', 'RechargeAdjustReduce', 'RechargeRefund', 'RechargeRollback')) and
                 (`b`.`site_type` = 'BOOKSTORE')
                 and `a`.`create_time` > DATE_SUB(curdate(), INTERVAL +9 DAY)
                ) and a.status = 'Succeed'
          group by `支付日期`, `站点`, `支付方式`, `站点ID`
union all select
            str_to_date(`a`.`create_time`, '%Y-%m-%d') AS `支付日期`,
            `b`.`station_name`                         AS `站点`,
            `d`.`pay_method_name`                      AS `支付方式`,
            sum(`a`.`pay_amount`)                      AS `支付金额`,
            '售卡充值退款'                                   AS `所属类别`,
            '书店'                                       AS `业务类型`,
            `b`.`station_code`                         AS `站点ID`
          from (((sisyphe_ods.`askcard_db_trade_record` `a`
            join sisyphe_ods.`coffee_baseinfo_v2_station` `b` on ((
              `a`.`station_code` =
              `b`.`station_code`))) join sisyphe_ods.`askcard_db_pay_detail` `c` on ((`a`.`trade_id` =
                                                                            `c`.`trade_id`))) join
            sisyphe_ods.`coffee_sale_pay_method` `d` on ((
              `c`.`pay_method_id` = `d`.`pay_method_code`)))
          where ((`a`.`trade_type` in
                  ('RechargeRefund', 'RechargeAdjustReduce', 'RechargeRollback')) and
                 (`b`.`site_type` = 'BOOKSTORE') and `a`.`create_time` > DATE_SUB(curdate(), INTERVAL +9 DAY)) and
                a.status = 'Succeed'
          group by `支付日期`, `站点`, `支付方式`, `站点ID`;

*/
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql数据源 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_sisyphe_edw</connection>
    <sql>select distinct yh_station_code,station_code,station_name,site_type from sisyphe_ods.coffee_baseinfo_v2_station</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql目的端</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_mysql</connection>
    <schema/>
    <table>cw_mysql_check</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql目的端 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_mysql</connection>
    <schema/>
    <table>cw_sqlserver_check_cq</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql目的端 2 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_mysql</connection>
    <schema/>
    <table>cw_sqlserver_check_gz</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql目的端 3</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_mysql</connection>
    <schema/>
    <table>station</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql目的端 4</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_mysql</connection>
    <schema/>
    <table>储值卡实际消费</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mysql目的端 4 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>172.16.2.229_mysql</connection>
    <schema/>
    <table>coupon</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>sqlserver数据源</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.2_cqbooks2</connection>
    <sql>-- 批销
select CONVERT(varchar(10),stock_date,21) as 支付日期,b.station_name as 站点,'书店' as 业务类型,'银行卡' as 支付方式,'批销' as 所属类别,sum(real_money) as 支付金额,a.station_id as 站点ID
from 
yw_px a
inner join 
db_station_total b
on a.station_id=b.station_id
-- where CONVERT(varchar(10),stock_date,21)='2018-11-18' and b.station_name like '%北京昌发展万科广场店%'
where CONVERT(varchar(10),stock_date,21)>convert(varchar(50),getdate()-9,23)
group by  CONVERT(varchar(10),stock_date,21),b.station_name,a.station_id

union all

-- 零售
SELECT
				CONVERT(varchar(10),a.ls_datetime,21) AS 支付日期,
				d.station_name as 站点,
					    '书店' as 业务类型,
				case when c.p_name='综合业务部提货券' then '大宗团购礼品券' else c.p_name end as 支付方式,
				           '零售' AS 所属类别,
				sum(b.pos_charge) as 支付金额,
				a.station_id as 站点ID
 
	
			FROM
			db_ls AS a
			LEFT JOIN db_station_total d ON a.station_id = d.station_id
			LEFT JOIN db_pos_muli_pay AS b ON a.ls_id = b.pos_id
			LEFT JOIN dz_paymethods AS c ON b.pos_pay_id = c.p_id
			-- WHERE  CONVERT(varchar(10),a.ls_datetime,21)  = '2018-11-18'  AND d.station_name LIKE '%北京昌发展万科广场店%' --万州万达
      where CONVERT(varchar(10),a.ls_datetime,21)>convert(varchar(50),getdate()-9,23) and a.real_money&lt;&gt;0
      group by 
       	 CONVERT(varchar(10),a.ls_datetime,21) ,
				d.station_name,
				c.p_name,
				a.station_id



/*
-- 批销
select str_to_date(`a`.`stock_date`, '%Y-%m-%d') as 支付日期,b.station_name as 站点,'书店' as 业务类型,'银行卡' as 支付方式,'批销' as 所属类别,sum(real_money) as 支付金额,a.station_id as 站点ID
from
sisyphe_ods.yw_px_cq a
inner join
sisyphe_ods.db_station_total_cq b
on a.station_id=b.station_id
-- where CONVERT(varchar(10),stock_date,21)='2018-11-18' and b.station_name like '%北京昌发展万科广场店%'
where str_to_date(`a`.`stock_date`, '%Y-%m-%d')>DATE_SUB(curdate(), INTERVAL +30 DAY)
group by  str_to_date(`a`.`stock_date`, '%Y-%m-%d'),b.station_name,a.station_id

union all

-- 零售
SELECT
				str_to_date(`a`.`ls_datetime`, '%Y-%m-%d') AS 支付日期,
				d.station_name as 站点,
					    '书店' as 业务类型,
				case when c.p_name='综合业务部提货券' then '大宗团购礼品券' else c.p_name end as 支付方式,
				           '零售' AS 所属类别,
				sum(b.pos_charge) as 支付金额,
				a.station_id as 站点ID


			FROM
			sisyphe_ods.db_ls_cq AS a
			LEFT JOIN sisyphe_ods.db_station_total_cq d ON a.station_id = d.station_id
			LEFT JOIN sisyphe_ods.db_pos_muli_pay_cq AS b ON a.ls_id = b.pos_id
			LEFT JOIN sisyphe_ods.dz_paymethods_cq AS c ON b.pos_pay_id = c.p_id
			-- WHERE  CONVERT(varchar(10),a.ls_datetime,21)  = '2018-11-18'  AND d.station_name LIKE '%北京昌发展万科广场店%' --万州万达
      where str_to_date(`a`.`ls_datetime`, '%Y-%m-%d')>DATE_SUB(curdate(), INTERVAL +30 DAY) and a.real_money&lt;&gt;0
      group by
       	 str_to_date(`a`.`ls_datetime`, '%Y-%m-%d'),
				d.station_name,
				c.p_name,
				a.station_id
*/</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>sqlserver数据源 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.0.2_xxfbooks</connection>
    <sql>
--批销
select CONVERT(varchar(10),stock_date,21) as 支付日期,b.station_name as 站点,'书店' as 业务类型,'银行卡' as 支付方式,'批销' as 所属类别,sum(real_money) as 支付金额,a.station_id as 站点ID
from 
yw_px a
inner join 
db_station_total b
on a.station_id=b.station_id
-- where CONVERT(varchar(10),stock_date,21)='2018-11-18' and b.station_name like '%北京昌发展万科广场店%'
where CONVERT(varchar(10),stock_date,21)>convert(varchar(50),getdate()-9,23)
group by  CONVERT(varchar(10),stock_date,21),b.station_name,a.station_id

union all

--零售
SELECT
				CONVERT(varchar(10),a.ls_datetime,21) AS 支付日期,
				d.station_name as 站点,
					    '书店' as 业务类型,
				case when c.p_name='综合业务部提货券' then '大宗团购礼品券' else c.p_name end as 支付方式,
				           '零售' AS 所属类别,
				sum(b.pos_charge) as 支付金额,
				a.station_id as 站点ID
 
	
			FROM
			db_ls AS a
			LEFT JOIN db_station_total d ON a.station_id = d.station_id
			LEFT JOIN db_pos_muli_pay AS b ON a.ls_id = b.pos_id
			LEFT JOIN dz_paymethods AS c ON b.pos_pay_id = c.p_id
			-- WHERE  CONVERT(varchar(10),a.ls_datetime,21)  = '2018-11-18'  AND d.station_name LIKE '%北京昌发展万科广场店%' --万州万达
      where CONVERT(varchar(10),a.ls_datetime,21)>convert(varchar(50),getdate()-9,23) and a.real_money&lt;&gt;0
      group by 
       	 CONVERT(varchar(10),a.ls_datetime,21) ,
				d.station_name,
				c.p_name,
				a.station_id


/*
-- 批销
select str_to_date(`a`.`stock_date`, '%Y-%m-%d') as 支付日期,b.station_name as 站点,'书店' as 业务类型,'银行卡' as 支付方式,'批销' as 所属类别,sum(real_money) as 支付金额,a.station_id as 站点ID
from
sisyphe_ods.yw_px_gz a
inner join
sisyphe_ods.db_station_total_gz b
on a.station_id=b.station_id
-- where CONVERT(varchar(10),stock_date,21)='2018-11-18' and b.station_name like '%北京昌发展万科广场店%'
where str_to_date(`a`.`stock_date`, '%Y-%m-%d')>DATE_SUB(curdate(), INTERVAL +30 DAY)
group by  str_to_date(`a`.`stock_date`, '%Y-%m-%d'),b.station_name,a.station_id

union all

-- 零售
SELECT
				str_to_date(`a`.`ls_datetime`, '%Y-%m-%d') AS 支付日期,
				d.station_name as 站点,
					    '书店' as 业务类型,
				case when c.p_name='综合业务部提货券' then '大宗团购礼品券' else c.p_name end as 支付方式,
				           '零售' AS 所属类别,
				sum(b.pos_charge) as 支付金额,
				a.station_id as 站点ID


			FROM
			sisyphe_ods.db_ls_gz AS a
			LEFT JOIN sisyphe_ods.db_station_total_gz d ON a.station_id = d.station_id
			LEFT JOIN sisyphe_ods.db_pos_muli_pay_gz AS b ON a.ls_id = b.pos_id
			LEFT JOIN sisyphe_ods.dz_paymethods_gz AS c ON b.pos_pay_id = c.p_id
			-- WHERE  CONVERT(varchar(10),a.ls_datetime,21)  = '2018-11-18'  AND d.station_name LIKE '%北京昌发展万科广场店%' --万州万达
      where str_to_date(`a`.`ls_datetime`, '%Y-%m-%d')>DATE_SUB(curdate(), INTERVAL +30 DAY) and a.real_money&lt;&gt;0
      group by
       	 str_to_date(`a`.`ls_datetime`, '%Y-%m-%d'),
				d.station_name,
				c.p_name,
				a.station_id
*/



</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
