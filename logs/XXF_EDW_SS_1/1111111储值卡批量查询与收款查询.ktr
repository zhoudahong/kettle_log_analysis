<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>111111储值卡查询</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2019/07/11 15:13:46.571</created_date>
    <modified_user>-</modified_user>
    <modified_date>2019/07/11 15:13:46.571</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>172.16.2.229_sisyphe_edw</name>
    <server>172.16.2.229</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>sisyphe_edw</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.21.44_sisyphe_dm</name>
    <server>192.168.21.44</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>sisyphe_dm</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.21.44_sisyphe_edw</name>
    <server>192.168.21.44</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>sisyphe_edw</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.21.44_sisyphe_ods</name>
    <server>192.168.21.44</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>sisyphe_ods</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>192.168.21.44_XXF_EDW</name>
    <server>192.168.21.44</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>XXF_EDW</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10cc9da0ce</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>logsystem_192.168.21.47</name>
    <server>192.168.21.47</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>logsystem</database>
    <port>3306</port>
    <username>e_tlx</username>
    <password>Encrypted 67515074daade2ac13e5a3a68003fa5df1a5fbee</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.defaultFetchSize</code>
        <attribute>500</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCursorFetch</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Mysql_192.168.21.47_askcard_db</name>
    <server>192.168.21.47</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>askcard_db</database>
    <port>3306</port>
    <username>e_tlx</username>
    <password>Encrypted 67515074daade2ac13e5a3a68003fa5df1a5fbee</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>批量查询</from>
      <to>表输出 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>收款查询</from>
      <to>表输出 2 2</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>批量查询</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Mysql_192.168.21.47_askcard_db</connection>
    <sql>SELECT
	t.trade_number as 交易单号,
	date_format(t.create_time, '%Y-%m-%d %H:%i:%S') as 时间,
	t.card_number as 卡号,
(case
            when ((`t`.`trade_type` = 'ExchangeCard') and (`t`.`in_out_flag` = 1)) then '换卡转入'
            when ((`t`.`trade_type` = 'ExchangeCard') and (`t`.`in_out_flag` = -(1))) then '换卡转出'
            when ((`t`.`trade_type` = 'TransferBalance') and (`t`.`in_out_flag` = 1)) then '余额转入'
            when ((`t`.`trade_type` = 'TransferBalance') and (`t`.`in_out_flag` = -(1))) then '余额转出'
            when (`t`.`trade_type` = 'CreateCard') then '制卡'
            when (`t`.`trade_type` = 'ActivatedCard') then '生效'
            when (`t`.`trade_type` = 'UnactivatedCard') then '失效'
            when (`t`.`trade_type` = 'Lock') then '冻结'
            when (`t`.`trade_type` = 'Unlock') then '解冻'
            when (`t`.`trade_type` = 'Lost') then '挂失'
            when (`t`.`trade_type` = 'Recovered') then '解挂'
            when (`t`.`trade_type` = 'MakeAbnormal') then '卡异常'
            when (`t`.`trade_type` = 'Renew') then '解除卡异常'
            when (`t`.`trade_type` = 'ChangePassword') then '修改密码'
            when (`t`.`trade_type` = 'ClearPassword') then '清空密码'
            when (`t`.`trade_type` = 'FirstPassword') then '新设密码'
            when (`t`.`trade_type` = 'SystemAdjustIn') then '系统调账增加'
            when (`t`.`trade_type` = 'SystemAdjustOut') then '系统调账减少'
            when (`t`.`trade_type` = 'AdjustIn') then '金额调整-增加'
            when (`t`.`trade_type` = 'AdjustOut') then '金额调整-减少'
            when (`t`.`trade_type` = 'ConsumeRollback') then '消费撤单'
            when (`t`.`trade_type` = 'DestroyCard') then '退卡余额'
            when (`t`.`trade_type` = 'AdjustAccount') then '金额调整'
            when (`t`.`trade_type` = 'RechargeRefund') then '充值退款'
            when (`t`.`trade_type` = 'Recharge') then '充值'
            when (`t`.`trade_type` = 'Consume') then '零售支出'
            when (`t`.`trade_type` = 'CardConsume') then '划卡消费'
            when (`t`.`trade_type` = 'CardConsumeRefund') then '划卡消费退款'
            when (`t`.`trade_type` = 'RechargeRollback') then '充值撤单'
            when (`t`.`trade_type` = 'ConsumeRefund') then '消费退款'
            when (`t`.`trade_type` = 'RepeatCardRecharge') then '重复卡办理'
            when (`t`.`trade_type` = 'RechargeAdjustAdd') then '充值调整 - 增加'
            when (`t`.`trade_type` = 'RechargeAdjustReduce') then '充值调整 - 减少'
            when (`t`.`trade_type` = 'ConsumeAdjustAdd') then '消费调整 - 增加'
            when (`t`.`trade_type` = 'ConsumeAdjustReduce') then '消费调整 - 减少'
            else `t`.`trade_type` end)  AS 操作类型,
  e.station_name as 操作站点,
	 case when `c`.`status`='Unactivated' then '未生效'
              when `c`.`status`='Locked' then '冻结'
             when `c`.`status`='Available' then '正常'
             when `c`.`status`='Lost' then '挂失'
             when `c`.`status`='Destroyed' then '注销'
             when `c`.`status`='Abnormal' then '异常'
             else `c`.`status` end  AS 卡状态,

	t.in_out_flag * t.trade_amount AS '充值码洋',
	t.in_out_flag * t.pay_amount AS '充值实洋',
	(
		SELECT
			sum(pay_amount) * t.in_out_flag
		FROM
			pay_detail
		WHERE
			trade_id = t.trade_id
		AND pay_method_id = '0001'
	) AS '现金',
	(
		SELECT
			sum(pay_amount) * t.in_out_flag
		FROM
			pay_detail
		WHERE
			trade_id = t.trade_id
		AND pay_method_id = '0005'
	) AS '银行卡',
	(
		SELECT
			sum(pay_amount) * t.in_out_flag
		FROM
			pay_detail
		WHERE
			trade_id = t.trade_id
		AND pay_method_id = '0002'
	) AS '微信',
	(
		SELECT
			sum(pay_amount) * t.in_out_flag
		FROM
			pay_detail
		WHERE
			trade_id = t.trade_id
		AND pay_method_id = '0003'
	) AS '支付宝',
	concat(d.user_name,'(',t.operator_code,')') as 操作人,
	t.memo as 备注
FROM
	trade_record t
LEFT JOIN card_info c ON t.card_id = c.card_id
left join oauth_database.user d on t.operator_code= d.user_code
left join coffee_baseinfo_v2.station e on t.station_code=e.station_code
WHERE
	t.trade_type IN (
		'Recharge',
		'RechargeRollback',
		'RechargeAdjustAdd',
		'RechargeAdjustReduce'
	)
AND t. STATUS = 'Succeed'

	AND date_format(t.create_time, '%Y-%m-%d')='${DATES}'
/*
AND t.station_code IN ('HGHB02')
AND t.operator_code = 'HGHAA546'
and
t.trade_number='CTYNC025ELPIGGP'
	 */
ORDER BY
	t.trade_id DESC

</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>377</xloc>
      <yloc>120</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>收款查询</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Mysql_192.168.21.47_askcard_db</connection>
    <sql>select trade.trade_number,date_format(trade.create_time, '%Y-%m-%d %H:%i:%S')create_time,trade.card_number,trade.trade_type,trade.station_code,date_format(trade.update_time, '%Y-%m-%d %H:%i:%S')update_time,
                        CASE WHEN   trade.in_out_flag=1  then trade.trade_amount else null end  'recharge_amount',
                        CASE WHEN  trade.in_out_flag =1 then trade.pay_amount else null end  'recharge_amount_real',
                        CASE WHEN  trade.in_out_flag=1 then (trade.pay_amount)/(trade.trade_amount) else null end  'recharge_discount',
                        CASE WHEN  trade.in_out_flag=-1 then trade.trade_amount else null end   'consume_amount_real' ,
                        CASE WHEN position(trade.trade_type in 'Consume,CardConsume,RechargeRefund,RechargeRollback,SystemAdjustOut,AdjustOut,DestroyCard,RechargeAdjustReduce,ConsumeAdjustAdd' ) THEN (
                            CASE WHEN (select offset_consume_id  from offset_consume where offset_consume.trade_number = trade.trade_number LIMIT 0,1) is not null
                                THEN (select SUM(offset_consume.offset_consume_amount*offset_consume.offset_consume_discount)  from offset_consume where offset_consume.trade_number = trade.trade_number)
                                else 0 end
                        )
                        WHEN  position(trade.trade_type in 'ExchangeCard,TransferBalance,RepeatCardRecharge') THEN (
                            CASE
                              WHEN trade.in_out_flag = -1 THEN (select SUM(offset_consume.offset_consume_amount *
                                                                           offset_consume.offset_consume_discount)
                                                                from offset_consume
                                                                where offset_consume.trade_number = trade.trade_number)
                              ELSE null END
                            )
                        ELSE null END 'cost_amount',
                         CASE WHEN  position(trade.trade_type in 'Consume,CardConsume,RechargeRefund,RechargeRollback,SystemAdjustOut,AdjustOut,DestroyCard,RechargeAdjustReduce,ConsumeAdjustAdd' ) then(
                           CASE WHEN
                              (select offset_consume_id  from offset_consume where offset_consume.trade_number = trade.trade_number  LIMIT 0,1) is not null
                           THEN (select SUM(offset_consume.offset_consume_amount*offset_consume.offset_consume_discount)  from offset_consume where offset_consume.trade_number = trade.trade_number) /(trade.trade_amount)
                           else 0 END
                         )
                         WHEN position(trade.trade_type in 'ExchangeCard,TransferBalance,RepeatCardRecharge') THEN (
                           CASE WHEN trade.in_out_flag=-1 THEN
                            (select SUM(offset_consume.offset_consume_amount*offset_consume.offset_consume_discount)  from offset_consume where offset_consume.trade_number = trade.trade_number) /(trade.trade_amount)
                            ELSE null END
                        )
                         else null END 'cost_discount',
                        trade.balance,trade.status,trade.card_class,trade.has_password,trade.operator_code,trade.memo,trade.source_id,trade.in_out_flag ,
                        CASE WHEN trade.trade_type = 'ExchangeCard' and trade.in_out_flag=-1 then  (
                            select trade_number from trade_record tr where tr.parent_id =trade.trade_id )
                        ELSE trade.trade_number  END 'change_card_trade_number' ,trade.batch_record_number ,
                        CASE WHEN trade.trade_number IS NOT null THEN (
                            select GROUP_CONCAT(pay_detail.pay_method_id) from pay_detail where trade.trade_id = pay_detail.trade_id )else null end 'pay_method_names', tradeStatus,trade_code, card_area, parent_trade_number

                    FROM(
                        select t.trade_number,t.trade_type,t.pay_amount, t.trade_amount,t.in_out_flag,
                        t.create_time,c.card_number,t.station_code,t.balance,c.status,c.card_class,
                        CASE WHEN (c.password is not null and c.password&lt;&gt;'') then true else false end  as has_password,
                        t.operator_code,t.memo,t.source_id ,t.batch_record_number ,t.trade_id,t.update_time,t.status as tradeStatus,trade_code,c.card_area,t.parent_trade_number
FROM trade_record t left join card_info c on t.card_id=c.card_id where t.status='Succeed' and date_format(t.create_time, '%Y-%m-%d')='${DATES}'
                        ) trade</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>377</xloc>
      <yloc>232</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_sisyphe_edw</connection>
    <schema/>
    <table>stored_receivables</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>649</xloc>
      <yloc>120</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出 2 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>192.168.21.44_sisyphe_edw</connection>
    <schema/>
    <table>stored_batch</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>649</xloc>
      <yloc>232</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
